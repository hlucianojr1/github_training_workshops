# üéÆ AI Demo - Game High Score Tracker

A Spring Boot REST API application for tracking game high scores with SQLite/H2 (local) and PostgreSQL (production) support.

## üöÄ Features

- **Score Submission**: Submit high scores with player name, game name, score, and optional timestamp
- **Score Retrieval**: Get scores by player, game, or combinations with pagination support
- **Top Scores**: Retrieve top N scores for any game
- **Statistics**: Get game and player statistics
- **Database Support**: H2 for local development, PostgreSQL for production
- **REST API**: Full RESTful API with comprehensive endpoints
- **Validation**: Input validation and error handling
- **H2 Console**: Database console for development (http://localhost:8080/h2-console)

## üèÉ‚Äç‚ôÇÔ∏è Quick Start

### Prerequisites
- Java 21+
- Gradle (or use included Gradle wrapper)

### Running Locally
```bash
# Clone the repository
git clone <repository-url>
cd ai-demo

# Run the application (uses H2 in-memory database)
./gradlew bootRun
```

The application will start on `http://localhost:8080`

### Running with PostgreSQL (Production)
```bash
# Set environment variables
export DATABASE_URL=jdbc:postgresql://localhost:5432/highscores
export DATABASE_USERNAME=your_username
export DATABASE_PASSWORD=your_password

# Run with production profile
./gradlew bootRun --args='--spring.profiles.active=prod'
```

## üì° API Endpoints

### Score Submission

#### Submit a High Score
```http
POST /api/scores/submit
Content-Type: application/json

{
  "playerName": "Alice",
  "gameName": "Pac-Man",
  "score": 125000,
  "achievedAt": "2024-01-15T14:30:00"  // Optional - uses current time if not provided
}
```

### Score Retrieval

#### Get Top Scores for a Game
```http
GET /api/scores/game/{gameName}/top?limit=10
```

#### Get All Scores for a Game (Paginated)
```http
GET /api/scores/game/{gameName}?page=0&size=10
```

#### Get All Scores for a Player (Paginated)
```http
GET /api/scores/player/{playerName}?page=0&size=10
```

#### Get Player's Scores in a Specific Game
```http
GET /api/scores/player/{playerName}/game/{gameName}?page=0&size=10
```

#### Get Player's High Score in a Game
```http
GET /api/scores/player/{playerName}/game/{gameName}/high-score
```

#### Get Specific Score by ID
```http
GET /api/scores/{id}
```

### Lists and Statistics

#### Get All Games
```http
GET /api/scores/games
```

#### Get All Players
```http
GET /api/scores/players
```

#### Get Game Statistics
```http
GET /api/scores/game/{gameName}/stats
```

#### Get Player Statistics
```http
GET /api/scores/player/{playerName}/stats
```

## üß™ Testing

### Using HTTP Files (VS Code)
The project includes comprehensive HTTP test files:

1. **`game-score-tests.http`** - Complete test suite for game score API
2. **`api-tests.http`** - Basic API tests
3. **`comprehensive-api-tests.http`** - Advanced API tests

Open any `.http` file in VS Code and click "Send Request" above each HTTP request.

### Using the Test Script
```bash
# Run automated API tests
./test-api.sh
```

### Using curl Examples
```bash
# Submit a score
curl -X POST http://localhost:8080/api/scores/submit \
  -H "Content-Type: application/json" \
  -d '{"playerName":"Alice","gameName":"Pac-Man","score":125000}'

# Get top scores
curl http://localhost:8080/api/scores/game/Pac-Man/top?limit=5

# Get all games
curl http://localhost:8080/api/scores/games
```

## üóÑÔ∏è Database Configuration

### Development (H2)
- **URL**: `jdbc:h2:mem:testdb`
- **Username**: `sa`
- **Password**: (empty)
- **Console**: http://localhost:8080/h2-console

### Production (PostgreSQL)
Configure via environment variables:
- `DATABASE_URL`: PostgreSQL connection URL
- `DATABASE_USERNAME`: Database username
- `DATABASE_PASSWORD`: Database password

## üìä Database Schema

### GameScore Entity
```sql
CREATE TABLE game_scores (
    id BIGINT PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    player_name VARCHAR(100) NOT NULL,
    game_name VARCHAR(100) NOT NULL,
    score BIGINT NOT NULL,
    achieved_at TIMESTAMP NOT NULL,
    created_at TIMESTAMP NOT NULL
);
```

## üîß Configuration

### Application Properties
- **Default Profile**: `application.properties` (H2 database)
- **Production Profile**: `application-prod.properties` (PostgreSQL)

### Key Configuration Options
```properties
# Database
spring.datasource.url=jdbc:h2:mem:testdb
spring.jpa.hibernate.ddl-auto=create-drop

# Logging
logging.level.com.insight.ai_demo=INFO
logging.level.org.hibernate.SQL=DEBUG

# Server
server.port=8080
```

## üìù API Response Format

### Successful Score Submission
```json
{
  "id": 1,
  "playerName": "Alice",
  "gameName": "Pac-Man",
  "score": 125000,
  "achievedAt": "2024-01-15T14:30:00",
  "createdAt": "2024-01-15T14:35:22"
}
```

### Paginated Response
```json
{
  "scores": [...],
  "totalElements": 25,
  "totalPages": 3,
  "currentPage": 0,
  "pageSize": 10,
  "hasNext": true,
  "hasPrevious": false
}
```

### Game Statistics
```json
{
  "gameName": "Pac-Man",
  "totalScores": 15,
  "highestScore": 156000
}
```

## üöÄ Deployment

### Local Development
```bash
./gradlew bootRun
```

### Production Build
```bash
./gradlew build
java -jar build/libs/ai-demo-0.0.1-SNAPSHOT.jar --spring.profiles.active=prod
```

### Docker (Future Enhancement)
```bash
# Build Docker image
docker build -t ai-demo .

# Run with PostgreSQL
docker run -p 8080:8080 \
  -e DATABASE_URL=jdbc:postgresql://host:5432/db \
  -e DATABASE_USERNAME=user \
  -e DATABASE_PASSWORD=pass \
  ai-demo --spring.profiles.active=prod
```

## üîç Monitoring and Debugging

### Health Check
```http
GET /health
```

### H2 Console (Development Only)
Access at: http://localhost:8080/h2-console
- JDBC URL: `jdbc:h2:mem:testdb`
- Username: `sa`
- Password: (empty)

### Logging
The application provides detailed logging for:
- Score submissions
- Database queries
- API requests
- Error handling

## ü§ù Contributing

1. Fork the repository
2. Create a feature branch
3. Add tests for new features
4. Submit a pull request

## üìÑ License

This project is licensed under the MIT License - see the LICENSE file for details.

---

## üìö Additional Resources

- [Spring Boot Documentation](https://spring.io/projects/spring-boot)
- [Spring Data JPA](https://spring.io/projects/spring-data-jpa)
- [H2 Database](http://www.h2database.com/)
- [PostgreSQL](https://www.postgresql.org/)