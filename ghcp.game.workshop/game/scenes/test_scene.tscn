[gd_scene load_steps=14 format=3 uid="uid://dtest001scene"]

[ext_resource type="Script" uid="uid://cckimanflqcob" path="res://scenes/test_scene.gd" id="1_script"]
[ext_resource type="PackedScene" uid="uid://hudscene001" path="res://scenes/ui/hud.tscn" id="2_hud"]
[ext_resource type="PackedScene" uid="uid://crcqnmldecx5k" path="res://assets/models/characters/char_player_male_placeholder.gltf" id="3_player_model"]
[ext_resource type="PackedScene" uid="uid://weapon_m1911_001" path="res://scenes/weapons/m1911.tscn" id="4_m1911"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_1"]
radius = 0.35
height = 1.75

[sub_resource type="BoxShape3D" id="BoxShape3D_2"]
size = Vector3(100, 1, 100)

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_1960s"]
sky_top_color = Color(0.467, 0.533, 0.6, 1)
sky_horizon_color = Color(0.663, 0.663, 0.663, 1)
sky_curve = 0.1
ground_bottom_color = Color(0.545, 0.451, 0.333, 1)
ground_horizon_color = Color(0.6, 0.533, 0.467, 1)
sun_curve = 0.05

[sub_resource type="Sky" id="Sky_1960s"]
sky_material = SubResource("ProceduralSkyMaterial_1960s")

[sub_resource type="Environment" id="Environment_1960s"]
background_mode = 2
sky = SubResource("Sky_1960s")
ambient_light_source = 2
ambient_light_color = Color(0.6, 0.533, 0.467, 1)
ambient_light_energy = 0.3
tonemap_mode = 2
tonemap_white = 6.0
ssao_enabled = true
ssao_radius = 1.5
glow_enabled = true
glow_intensity = 0.3
glow_bloom = 0.1
fog_enabled = true
fog_light_color = Color(0.7, 0.65, 0.6, 1)
fog_light_energy = 0.5
fog_density = 0.001
volumetric_fog_enabled = true
volumetric_fog_density = 0.02
volumetric_fog_albedo = Color(0.8, 0.75, 0.7, 1)
adjustment_enabled = true
adjustment_contrast = 1.1
adjustment_saturation = 0.8

[sub_resource type="BoxShape3D" id="BoxShape3D_Enemy"]
size = Vector3(1, 2, 1)

[sub_resource type="BoxMesh" id="BoxMesh_Enemy"]
size = Vector3(1, 2, 1)

[sub_resource type="StandardMaterial3D" id="EnemyMaterial"]
albedo_color = Color(0.8, 0.2, 0.2, 1)

[node name="TestScene" type="Node3D"]
script = ExtResource("1_script")

[node name="Player" type="PlayerController" parent="." groups=["player"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.875, 0)
shape = SubResource("CapsuleShape3D_1")

[node name="CharacterModel" parent="Player" instance=ExtResource("3_player_model")]

[node name="CameraPivot" type="Node3D" parent="Player"]

[node name="Camera3D" type="Camera3D" parent="Player/CameraPivot"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 5)

[node name="SurvivalStats" type="SurvivalStats" parent="Player"]

[node name="Inventory" type="Inventory" parent="Player"]

[node name="Weapon" parent="Player" instance=ExtResource("4_m1911")]

[node name="MuzzlePoint" type="Marker3D" parent="Player/Weapon"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -1)

[node name="Ground" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="Ground"]
shape = SubResource("BoxShape3D_2")

[node name="GroundMesh" type="CSGBox3D" parent="Ground"]
size = Vector3(100, 1, 100)

[node name="Building1" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 15, 10, -20)
size = Vector3(10, 20, 10)

[node name="Building2" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -12, 7.5, -15)
size = Vector3(8, 15, 12)

[node name="Building3" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 25, 12.5, 10)
size = Vector3(12, 25, 8)

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(0.866, -0.354, 0.354, 0, 0.707, 0.707, -0.5, -0.612, 0.612, 0, 20, 0)
light_color = Color(0.96, 0.9, 0.85, 1)
light_energy = 0.8
light_volumetric_fog_energy = 1.5
shadow_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_1960s")

[node name="HUD" parent="." instance=ExtResource("2_hud")]

[node name="TestEnemy" type="EnemyAI" parent="."]
attack_range = 2.5
ai_accuracy = 0.5
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8, 1, -5)

[node name="CollisionShape3D" type="CollisionShape3D" parent="TestEnemy"]
shape = SubResource("BoxShape3D_Enemy")

[node name="EnemyMesh" type="MeshInstance3D" parent="TestEnemy"]
mesh = SubResource("BoxMesh_Enemy")
surface_material_override/0 = SubResource("EnemyMaterial")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="TestEnemy"]

[node name="AIPerception" type="AIPerception" parent="TestEnemy"]
sight_range = 20.0
sight_angle = 90.0

[node name="Weapon" parent="TestEnemy" instance=ExtResource("4_m1911")]
